#Requires AutoHotkey >=2.0

global numpad_input := ""
global alt_code_map := Map()
global alt_down_time := 0

; Define character mappings
alt_code_map["VAL_0216"] := "U+2300"
alt_code_map["VAL_255"] := "U+00A0"
alt_code_map["VAL_173"] := "U+00A1"
alt_code_map["VAL_155"] := "U+00A2"
alt_code_map["VAL_156"] := "U+00A3"
alt_code_map["VAL_207"] := "U+00A4"
alt_code_map["VAL_157"] := "U+00A5"
alt_code_map["VAL_221"] := "U+00A6"
alt_code_map["VAL_21"] := "U+00A7"
alt_code_map["VAL_249"] := "U+00A8"
alt_code_map["VAL_184"] := "U+00A9"
alt_code_map["VAL_166"] := "U+00AA"
alt_code_map["VAL_174"] := "U+00AB"
alt_code_map["VAL_170"] := "U+00AC"
alt_code_map["VAL_240"] := "U+00AD"
alt_code_map["VAL_169"] := "U+00AE"
alt_code_map["VAL_238"] := "U+00AF"
alt_code_map["VAL_248"] := "U+00B0"
alt_code_map["VAL_241"] := "U+00B1"
alt_code_map["VAL_253"] := "U+00B2"
alt_code_map["VAL_252"] := "U+00B3"
alt_code_map["VAL_239"] := "U+00B4"
alt_code_map["VAL_230"] := "U+00B5"
alt_code_map["VAL_20"] := "U+00B6"
alt_code_map["VAL_250"] := "U+00B7"
alt_code_map["VAL_247"] := "U+00B8"
alt_code_map["VAL_251"] := "U+00B9"
alt_code_map["VAL_167"] := "U+00BA"
alt_code_map["VAL_175"] := "U+00BB"
alt_code_map["VAL_172"] := "U+00BC"
alt_code_map["VAL_171"] := "U+00BD"
alt_code_map["VAL_243"] := "U+00BE"
alt_code_map["VAL_168"] := "U+00BF"
alt_code_map["VAL_183"] := "U+00C0"
alt_code_map["VAL_181"] := "U+00C1"
alt_code_map["VAL_182"] := "U+00C2"
alt_code_map["VAL_199"] := "U+00C3"
alt_code_map["VAL_142"] := "U+00C4"
alt_code_map["VAL_143"] := "U+00C5"
alt_code_map["VAL_146"] := "U+00C6"
alt_code_map["VAL_128"] := "U+00C7"
alt_code_map["VAL_212"] := "U+00C8"
alt_code_map["VAL_144"] := "U+00C9"
alt_code_map["VAL_210"] := "U+00CA"
alt_code_map["VAL_211"] := "U+00CB"
alt_code_map["VAL_222"] := "U+00CC"
alt_code_map["VAL_214"] := "U+00CD"
alt_code_map["VAL_215"] := "U+00CE"
alt_code_map["VAL_216"] := "U+00CF"
alt_code_map["VAL_209"] := "U+00D0"
alt_code_map["VAL_165"] := "U+00D1"
alt_code_map["VAL_227"] := "U+00D2"
alt_code_map["VAL_224"] := "U+00D3"
alt_code_map["VAL_226"] := "U+00D4"
alt_code_map["VAL_229"] := "U+00D5"
alt_code_map["VAL_153"] := "U+00D6"
alt_code_map["VAL_158"] := "U+00D7"
alt_code_map["VAL_157"] := "U+00D8"
alt_code_map["VAL_235"] := "U+00D9"
alt_code_map["VAL_233"] := "U+00DA"
alt_code_map["VAL_234"] := "U+00DB"
alt_code_map["VAL_154"] := "U+00DC"
alt_code_map["VAL_237"] := "U+00DD"
alt_code_map["VAL_232"] := "U+00DE"
alt_code_map["VAL_225"] := "U+00DF"
alt_code_map["VAL_133"] := "U+00E0"
alt_code_map["VAL_160"] := "U+00E1"
alt_code_map["VAL_131"] := "U+00E2"
alt_code_map["VAL_198"] := "U+00E3"
alt_code_map["VAL_132"] := "U+00E4"
alt_code_map["VAL_134"] := "U+00E5"
alt_code_map["VAL_145"] := "U+00E6"
alt_code_map["VAL_135"] := "U+00E7"
alt_code_map["VAL_138"] := "U+00E8"
alt_code_map["VAL_130"] := "U+00E9"
alt_code_map["VAL_136"] := "U+00EA"
alt_code_map["VAL_137"] := "U+00EB"
alt_code_map["VAL_141"] := "U+00EC"
alt_code_map["VAL_161"] := "U+00ED"
alt_code_map["VAL_140"] := "U+00EE"
alt_code_map["VAL_139"] := "U+00EF"
alt_code_map["VAL_208"] := "U+00F0"
alt_code_map["VAL_164"] := "U+00F1"
alt_code_map["VAL_149"] := "U+00F2"
alt_code_map["VAL_162"] := "U+00F3"
alt_code_map["VAL_147"] := "U+00F4"
alt_code_map["VAL_228"] := "U+00F5"
alt_code_map["VAL_148"] := "U+00F6"
alt_code_map["VAL_246"] := "U+00F7"
alt_code_map["VAL_155"] := "U+00F8"
alt_code_map["VAL_151"] := "U+00F9"
alt_code_map["VAL_163"] := "U+00FA"
alt_code_map["VAL_150"] := "U+00FB"
alt_code_map["VAL_129"] := "U+00FC"
alt_code_map["VAL_236"] := "U+00FD"
alt_code_map["VAL_231"] := "U+00FE"
alt_code_map["VAL_152"] := "U+00FF"
alt_code_map["VAL_213"] := "U+0131"
alt_code_map["VAL_0140"] := "U+0152"
alt_code_map["VAL_0156"] := "U+0153"
alt_code_map["VAL_0138"] := "U+0160"
alt_code_map["VAL_0154"] := "U+0161"
alt_code_map["VAL_0159"] := "U+0178"
alt_code_map["VAL_0142"] := "U+017D"
alt_code_map["VAL_0158"] := "U+017E"
alt_code_map["VAL_159"] := "U+0192"
alt_code_map["VAL_0136"] := "U+02C6"
alt_code_map["VAL_0152"] := "U+02DC"
alt_code_map["VAL_226"] := "U+0393"
alt_code_map["VAL_233"] := "U+0398"
alt_code_map["VAL_228"] := "U+03A3"
alt_code_map["VAL_232"] := "U+03A6"
alt_code_map["VAL_234"] := "U+03A9"
alt_code_map["VAL_224"] := "U+03B1"
alt_code_map["VAL_235"] := "U+03B4"
alt_code_map["VAL_238"] := "U+03B5"
alt_code_map["VAL_227"] := "U+03C0"
alt_code_map["VAL_229"] := "U+03C3"
alt_code_map["VAL_231"] := "U+03C4"
alt_code_map["VAL_237"] := "U+03C6"
alt_code_map["VAL_0150"] := "U+2013"
alt_code_map["VAL_0151"] := "U+2014"
alt_code_map["VAL_242"] := "U+2017"
alt_code_map["VAL_0145"] := "U+2018"
alt_code_map["VAL_0146"] := "U+2019"
alt_code_map["VAL_0130"] := "U+201A"
alt_code_map["VAL_0147"] := "U+201C"
alt_code_map["VAL_0148"] := "U+201D"
alt_code_map["VAL_0132"] := "U+201E"
alt_code_map["VAL_0134"] := "U+2020"
alt_code_map["VAL_0135"] := "U+2021"
alt_code_map["VAL_7"] := "U+2022"
alt_code_map["VAL_0133"] := "U+2026"
alt_code_map["VAL_0137"] := "U+2030"
alt_code_map["VAL_0139"] := "U+2039"
alt_code_map["VAL_0155"] := "U+203A"
alt_code_map["VAL_19"] := "U+203C"
alt_code_map["VAL_252"] := "U+207F"
alt_code_map["VAL_158"] := "U+20A7"
alt_code_map["VAL_0128"] := "U+20AC"
alt_code_map["VAL_0153"] := "U+2122"
alt_code_map["VAL_27"] := "U+2190"
alt_code_map["VAL_24"] := "U+2191"
alt_code_map["VAL_26"] := "U+2192"
alt_code_map["VAL_25"] := "U+2193"
alt_code_map["VAL_29"] := "U+2194"
alt_code_map["VAL_18"] := "U+2195"
alt_code_map["VAL_23"] := "U+21A8"
alt_code_map["VAL_249"] := "U+2219"
alt_code_map["VAL_251"] := "U+221A"
alt_code_map["VAL_236"] := "U+221E"
alt_code_map["VAL_28"] := "U+221F"
alt_code_map["VAL_239"] := "U+2229"
alt_code_map["VAL_247"] := "U+2248"
alt_code_map["VAL_243"] := "U+2264"
alt_code_map["VAL_240"] := "U+2261"
alt_code_map["VAL_242"] := "U+2265"
alt_code_map["VAL_127"] := "U+2302"
alt_code_map["VAL_169"] := "U+2310"
alt_code_map["VAL_244"] := "U+2320"
alt_code_map["VAL_245"] := "U+2321"
alt_code_map["VAL_196"] := "U+2500"
alt_code_map["VAL_179"] := "U+2502"
alt_code_map["VAL_218"] := "U+250C"
alt_code_map["VAL_191"] := "U+2510"
alt_code_map["VAL_192"] := "U+2514"
alt_code_map["VAL_217"] := "U+2518"
alt_code_map["VAL_195"] := "U+251C"
alt_code_map["VAL_180"] := "U+2524"
alt_code_map["VAL_194"] := "U+252C"
alt_code_map["VAL_193"] := "U+2534"
alt_code_map["VAL_197"] := "U+253C"
alt_code_map["VAL_205"] := "U+2550"
alt_code_map["VAL_186"] := "U+2551"
alt_code_map["VAL_213"] := "U+2552"
alt_code_map["VAL_214"] := "U+2553"
alt_code_map["VAL_201"] := "U+2554"
alt_code_map["VAL_184"] := "U+2555"
alt_code_map["VAL_183"] := "U+2556"
alt_code_map["VAL_187"] := "U+2557"
alt_code_map["VAL_212"] := "U+2558"
alt_code_map["VAL_211"] := "U+2559"
alt_code_map["VAL_200"] := "U+255A"
alt_code_map["VAL_190"] := "U+255B"
alt_code_map["VAL_189"] := "U+255C"
alt_code_map["VAL_188"] := "U+255D"
alt_code_map["VAL_198"] := "U+255E"
alt_code_map["VAL_199"] := "U+255F"
alt_code_map["VAL_204"] := "U+2560"
alt_code_map["VAL_182"] := "U+2562"
alt_code_map["VAL_185"] := "U+2563"
alt_code_map["VAL_209"] := "U+2564"
alt_code_map["VAL_210"] := "U+2565"
alt_code_map["VAL_203"] := "U+2566"
alt_code_map["VAL_207"] := "U+2567"
alt_code_map["VAL_208"] := "U+2568"
alt_code_map["VAL_202"] := "U+2569"
alt_code_map["VAL_216"] := "U+256A"
alt_code_map["VAL_215"] := "U+256B"
alt_code_map["VAL_206"] := "U+256C"
alt_code_map["VAL_223"] := "U+2580"
alt_code_map["VAL_220"] := "U+2584"
alt_code_map["VAL_219"] := "U+2588"
alt_code_map["VAL_221"] := "U+258C"
alt_code_map["VAL_222"] := "U+2590"
alt_code_map["VAL_176"] := "U+2591"
alt_code_map["VAL_177"] := "U+2592"
alt_code_map["VAL_178"] := "U+2593"
alt_code_map["VAL_254"] := "U+25A0"
alt_code_map["VAL_22"] := "U+25AC"
alt_code_map["VAL_30"] := "U+25B2"
alt_code_map["VAL_16"] := "U+25BA"
alt_code_map["VAL_31"] := "U+25BC"
alt_code_map["VAL_17"] := "U+25C4"
alt_code_map["VAL_9"] := "U+25CB"
alt_code_map["VAL_8"] := "U+25D8"
alt_code_map["VAL_10"] := "U+25D9"
alt_code_map["VAL_1"] := "U+263A"
alt_code_map["VAL_2"] := "U+263B"
alt_code_map["VAL_15"] := "U+263C"
alt_code_map["VAL_12"] := "U+2640"
alt_code_map["VAL_11"] := "U+2642"
alt_code_map["VAL_6"] := "U+2660"
alt_code_map["VAL_5"] := "U+2663"
alt_code_map["VAL_3"] := "U+2665"
alt_code_map["VAL_4"] := "U+2666"
alt_code_map["VAL_13"] := "U+266A"
alt_code_map["VAL_14"] := "U+266B"

SendMode "Input"
SetWorkingDir A_ScriptDir

; Hotkey setup for Left Alt
~LAlt::
{
    global alt_down_time
    alt_down_time := A_TickCount
    return
}

~LAlt Up::
{
    global alt_down_time, numpad_input
    if (A_TickCount - alt_down_time < 200 && numpad_input != "") {
        char := ConvertAltCodes(numpad_input)
        if (char != "") {
            SendInput "{" char "}"
        }
        numpad_input := ""
    }
    return
}

; Hotkey setup for numpad keys
Loop 10 {
    Hotkey "~LAlt & Numpad" . (A_Index - 1), AppendNumpadInput
}

ConvertAltCodes(input) {
    global alt_code_map
    string_input := "VAL_" input
    if (alt_code_map.Has(string_input)) {
        return alt_code_map[string_input]
    } else {
        return ""
    }
}

AppendNumpadInput(*) {
    global numpad_input
    key := SubStr(A_ThisHotkey, -1)
    numpad_input .= key
}
